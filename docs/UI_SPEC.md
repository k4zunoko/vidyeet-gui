# UI Spec

このドキュメントは、画面と状態遷移を固定するための仕様です。実装はここに追従させます。

## 画面一覧（現実装）

- 認証（Login）
- 一覧（Library）
- 再生（Player）※一覧画面内のメイン領域に表示

補足（画面を横断するUI要素）:

- カスタムタイトルバー（フレームレスウィンドウ）
- 右ドロワー（アップロード/ログアウト）
- グローバルコンテキストメニュー（リンクコピー/削除）
- 削除確認ダイアログ
- アップロード進捗ダイアログ

## 起動時状態遷移

1. App起動
2. 認証チェック中（`status` 実行）
3. `is_authenticated=true` なら一覧取得へ
4. 未認証なら認証画面へ（成功するまでブロック）

## UI/UXチェック項目（MVP）

この章は [UX_PSYCHOLOGY.md](./UX_PSYCHOLOGY.md) をベースに、MVPの画面ワイヤーで「どの原則をどこに適用するか」をチェック項目として固定します。

### 共通（全画面）

- 認知負荷: 画面上の選択肢・文言・情報量が、目的タスク（ログイン/一覧/再生）を邪魔していない
- 段階的開示: 今すぐ不要な情報/操作は隠せている（MVPでは“最短経路”を優先）
- 視覚的階層: 主行動（Primary Action）と次善行動が見分けられる
- ドハティの閾値: 0.4秒を超えそうな処理は、必ず「待ちのフィードバック」がある（スケルトン/プレースホルダ/短い状態文）
- フレーミング: エラー文言は断定や責める言い方を避け、次の行動（再試行/ログイン等）に収束する

## 認証画面（Login）

### 目的

- CLI にログイン処理を委譲し、成功/失敗をユーザーに返す

### 入力

- Token ID
- Token Secret

### 振る舞い

- 「ログイン」押下で CLI のログイン処理を開始
- 失敗時はエラー表示し、入力を保持して再試行可能
- 成功時は即座に一覧取得へ遷移

※ CLI は `login --stdin` により標準入力から認証情報を受け取れるため、GUI側では「入力→stdinへ渡す」方式を採用する。実装方針は [CLI_CONTRACT.md](./CLI_CONTRACT.md) に従う。

### UXチェック（Login）

- 認知負荷: 入力項目は必要最小限（Token ID / Token Secret のみ）で、補足説明は短くする
- 視覚的階層: Primary Action（ログイン）が最も目立つ。Secondary（キャンセル等）がある場合は控えめにする
- ドハティの閾値: ログイン実行中は「ログイン中…」等の状態を必ず表示し、ボタン二度押しを防ぐ
- ピーク・エンド: 成功時は短い肯定メッセージで区切り、失敗時は入力を保持して“復帰できる終わり方”にする
- フレーミング: 失敗理由は断定せず（例: “認証に失敗しました。Token ID/Secret を確認して再試行してください”）、次の一手を提示する

## 一覧画面（Library）

### 表示

- 動画カード（サムネイル、簡易メタ情報）を並べる
- サムネイルが取れない場合はエラー状態を表示（リトライ導線があれば尚良いがMVPでは必須ではない）

現実装の配置:

- 左: 一覧（サムネイルグリッド）
- 右: プレイヤー + 情報パネル

### 操作

- ホバー: GIF を表示
- クリック/選択: プレイヤーへ反映（HLS再生）

追加（現実装）:

- 右クリック: コンテキストメニューを表示
	- 対象は再生可能な動画のみ（`playback_id` があるもの）
- タイトルバーのメニュー操作で右ドロワーを開閉

### 取得

- 初回表示時に `list` を実行
- リロード操作を提供するかはMVPでは任意（実装する場合は `list` 再実行）

現実装:

- 初回表示で `list`
- タイトルバーのリロードで `list` を再実行

### UXチェック（Library）

- 認知負荷: カードに載せる情報を増やしすぎない（サムネ中心 + 最小の状態）
- 段階的開示: 詳細情報/高度操作（削除・コピー等の将来機能）は後から追加しても破綻しない配置にしておく（例: 右クリック、詳細パネル）
- 視覚的階層: 選択中/再生中のカードが一目で分かる（枠/ラベル等）
- ドハティの閾値: 一覧取得中はカード枠のプレースホルダ等で“待ち”を見せる（空白で待たせない）
- バナー・ブラインドネス: 重要な状態表示を広告バナー風にしない（見落とされない見た目にする）
- 決断疲れ: 操作を増やしすぎない（MVPでは「選択して再生」に集中）

## 再生（Player）

- 選択された `playback_id` から `https://stream.mux.com/{PLAYBACK_ID}.m3u8` を生成して再生
- 再生失敗時はエラー表示し、別動画選択や再試行ができる

追加（現実装）:

- プレイヤー領域でも右クリックでコンテキストメニューを表示できる（選択中動画がある場合）

## 情報パネル（Video Info）

- 選択中動画のメタ情報を表示する
- 表示項目（現実装・一覧取得データに基づく）:
	- 時間（mm:ss）
	- 解像度 / アスペクト比 / フレームレート
	- 作成日
	- ステータス

※ 追加の詳細取得（`show`）は現時点では行わない。

## コンテキストメニュー（右クリック）

表示条件:

- ライブラリのカード: `playback_id` がある動画のみ
- プレイヤー: 選択中かつ `playback_id` がある場合のみ

項目（現実装）:

- 「リンクをコピー」: MP4 URL（`/highest.mp4`）をクリップボードにコピー
- 「削除」: 削除確認ダイアログを開く

閉じ方:

- 外側クリック
- `Esc`

## 削除確認ダイアログ

- 破壊的操作のため、確認ダイアログを必須にする
- 「削除する」押下で `vidyeet:delete` を実行
- 削除中はボタンを無効化し、状態文言を表示
- 成功時はダイアログを閉じ、一覧から除去し、必要なら選択解除

## アップロードダイアログ

開始:

- ドロワーの「アップロード」押下
- ファイル選択ダイアログを表示（キャンセルで中断）

進捗:

- `vidyeet:upload` 実行中は進捗ダイアログを表示
- 進捗は `vidyeet:uploadProgress` イベントで更新する
- 完了時は短い成功表示の後に自動で閉じる

失敗:

- エラー文言を表示し、閉じる操作を提供する

## トースト通知

アクション完了のフィードバックをウィンドウ右下にポップアップ表示する。

### 表示仕様

- 表示位置: ウィンドウ右上（`top: 1rem; right: 1rem;`）
- 自動消去: 成功 3秒、エラー 5秒
- 最大表示数: 3件（超過時は古いものから削除）
- アニメーション: 0.2秒のスライドイン（右から）/フェードアウト
- レイアウト: 最新の通知が常に右上の固定位置に表示され、古い通知が下に押し出される

### タイプ別デザイン

| タイプ | 左ボーダー色 | 用途 |
|--------|-------------|------|
| success | 緑（`--color-success`） | 成功通知 |
| error | 赤（`--color-error`） | エラー通知 |
| info | ピンク（`--color-primary`） | 情報通知 |

### 適用アクション

| アクション | タイプ | メッセージ |
|-----------|-------|-----------|
| URLコピー | success | 「リンクをコピーしました」 |
| 動画削除 | success | 「動画を削除しました」 |
| アップロード完了 | success | 「アップロードが完了しました」 |

### UXチェック（Toast）

- ピーク・エンドの法則: 成功時は短く肯定的なメッセージで良い印象を残す
- ドハティの閾値: アクション直後に即時表示（0.4秒以内）
- 認知負荷: 最小限の情報量（アイコン + 短いメッセージ）
- バナー・ブラインドネス: 控えめだが見落とされないデザイン（左ボーダーで種別を示す）
- 視覚的階層: 主要操作領域（左の一覧、中央のプレイヤー）を邪魔しない右上配置、タイトルバーから適度に離れた位置

### UXチェック（Player）

- 視覚的階層: 再生状態（読み込み中/再生中/停止/エラー）が明確。次の操作が分かる
- ドハティの閾値: 初回バッファなど時間がかかる場合は、プレイヤー枠にローディングを出す
- 認知負荷: 再生に不要な情報を周辺に出しすぎない（まず“見れる/見れない”が分かる）
- ピーク・エンド: 再生開始時/失敗時の区切りが分かり、失敗しても復帰できる導線（別動画選択/再試行）がある

## ローディング/エラー表示方針

- CLI実行中はローディング状態を表示
- エラーは「次に何をすべきか」が分かる文言にする

詳細は [ERROR_HANDLING.md](./ERROR_HANDLING.md)。
